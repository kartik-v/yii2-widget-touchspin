!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=function(n,o){return void 0===o&&(o="undefined"!=typeof window?require("jquery"):require("jquery")(n)),t(o),o}:t(jQuery)}(function(t){"use strict";var n=0;t.fn.TouchSpin=function(o){var s={min:0,max:100,bsVersion:4,initval:"",replacementval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalup:"+",verticaldown:"-",verticalupclass:"",verticaldownclass:"",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-primary",buttonup_class:"btn btn-primary",buttondown_txt:"-",buttonup_txt:"+",callback_before_calculation:function(t){return t},callback_after_calculation:function(t){return t}},p={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){function a(){if(!A.data("alreadyinitialized")){if(A.data("alreadyinitialized",!0),n+=1,A.data("spinnerid",n),!A.is("input"))return void console.log("Must be an input.");u(),i(),w(),d(),h(),v(),x(),g()}}function i(){""!==N.initval&&""===A.val()&&A.val(N.initval)}function e(t){l(t),w();var n=q.input.val();""!==n&&(n=Number(N.callback_before_calculation(q.input.val())),q.input.val(N.callback_after_calculation(Number(n).toFixed(N.decimals))))}function u(){N=t.extend({},s,E,r(),o)}function r(){var n={};return t.each(p,function(t,o){var s="bts-"+o;A.is("[data-"+s+"]")&&(n[t]=A.data(s))}),n}function c(){var n=A.parent();D(),A.off(".touchspin"),n.hasClass("bootstrap-touchspin-injected")?(A.siblings().remove(),A.unwrap()):(t(".bootstrap-touchspin-injected",n).remove(),n.removeClass("bootstrap-touchspin")),A.data("alreadyinitialized",!1)}function l(n){if(N=t.extend({},N,n),n.postfix){var o=A.parent().find(".bootstrap-touchspin-postfix");0===o.length&&M.insertAfter(A),A.parent().find(".bootstrap-touchspin-postfix .input-group-text").text(n.postfix)}if(n.prefix){var s=A.parent().find(".bootstrap-touchspin-prefix");0===s.length&&F.insertBefore(A),A.parent().find(".bootstrap-touchspin-prefix .input-group-text").text(n.prefix)}v()}function d(){var t=A.val(),n=A.parent();""!==t&&(t=N.callback_after_calculation(Number(t).toFixed(N.decimals))),A.data("initvalue",t).val(t),A.addClass("form-control"),n.hasClass("input-group")?f(n):b()}function f(n){n.addClass("bootstrap-touchspin");var o,s,p=A.prev(),a=A.next(),i=N.bsVersion,e='<span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix input-group-prepend bootstrap-touchspin-injected"><span class="input-group-text">'+N.prefix+"</span></span>",u='<span class="input-group-addon input-group-append bootstrap-touchspin-postfix input-group-append bootstrap-touchspin-injected"><span class="input-group-text">'+N.postfix+"</span></span>";5==i&&(e='<span class="input-group-text bootstrap-touchspin-prefix">'+N.prefix+"</span>",u='<span class="input-group-text bootstrap-touchspin-postfix">'+N.postfix+"</span>"),p.hasClass("input-group-btn")||p.hasClass("input-group-prepend")?(o='<button class="'+N.buttondown_class+' bootstrap-touchspin-down bootstrap-touchspin-injected" type="button">'+N.buttondown_txt+"</button>",p.append(o)):(o=5==i?'<button class="'+N.buttondown_class+' bootstrap-touchspin-down bootstrap-touchspin-injected" type="button">'+N.buttondown_txt+"</button>":'<span class="input-group-btn input-group-prepend bootstrap-touchspin-injected"><button class="'+N.buttondown_class+' bootstrap-touchspin-down" type="button">'+N.buttondown_txt+"</button></span>",t(o).insertBefore(A)),a.hasClass("input-group-btn")||a.hasClass("input-group-append")?(s='<button class="'+N.buttonup_class+' bootstrap-touchspin-up bootstrap-touchspin-injected" type="button">'+N.buttonup_txt+"</button>",a.prepend(s)):(s=5==i?'<button class="'+N.buttonup_class+' bootstrap-touchspin-up bootstrap-touchspin-injected" type="button">'+N.buttonup_txt+"</button>":'<span class="input-group-btn input-group-append bootstrap-touchspin-injected"><button class="'+N.buttonup_class+' bootstrap-touchspin-up" type="button">'+N.buttonup_txt+"</button></span>",t(s).insertAfter(A)),t(e).insertBefore(A),t(u).insertAfter(A),P=n}function b(){var n,o=N.bsVersion,s="";A.hasClass("input-sm")&&(s="input-group-sm"),A.hasClass("input-lg")&&(s="input-group-lg"),n=N.verticalbuttons?'<div class="input-group '+s+' bootstrap-touchspin bootstrap-touchspin-injected">'+(5!=o?'<span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix">':"")+'<span class="input-group-text'+(5==o?" bootstrap-touchspin-prefix":"")+'">'+N.prefix+"</span>"+(5!=o?"</span>":"")+(5!=o?'<span class="input-group-addon bootstrap-touchspin-postfix input-group-append">':"")+'<span class="input-group-text'+(5==o?" bootstrap-touchspin-postfix":"")+'">'+N.postfix+"</span>"+(5!=o?"</span>":"")+(5!=o?'<span class="input-group-addon input-group-append">':"")+'<span class="input-group-text input-group-btn-vertical"><button class="'+N.buttondown_class+" bootstrap-touchspin-up "+N.verticalupclass+'" type="button">'+N.verticalup+'</button><button class="'+N.buttonup_class+" bootstrap-touchspin-down "+N.verticaldownclass+'" type="button">'+N.verticaldown+"</button>"+(5!=o?"</span>":"")+"</span></div>":'<div class="input-group bootstrap-touchspin bootstrap-touchspin-injected">'+(5!=o?'<span class="input-group-btn input-group-prepend">':"")+'<button class="'+N.buttondown_class+' bootstrap-touchspin-down" type="button">'+N.buttondown_txt+"</button>"+(5!=o?"</span>":"")+(5!=o?'<span class="input-group-addon bootstrap-touchspin-prefix input-group-prepend">':"")+'<span class="input-group-text'+(5==o?" bootstrap-touchspin-prefix":"")+'">'+N.prefix+"</span>"+(5!=o?"</span>":"")+(5!=o?'<span class="input-group-addon bootstrap-touchspin-postfix input-group-append">':"")+'<span class="input-group-text'+(5==o?" bootstrap-touchspin-postfix":"")+'">'+N.postfix+"</span>"+(5!=o?"</span>":"")+(5!=o?'<span class="input-group-btn input-group-append">':"")+'<button class="'+N.buttonup_class+' bootstrap-touchspin-up" type="button">'+N.buttonup_txt+"</button>"+(5!=o?"</span>":"")+"</div>",P=t(n).insertBefore(A),t(".bootstrap-touchspin-prefix",P).after(A),A.hasClass("input-sm")?P.addClass("input-group-sm"):A.hasClass("input-lg")&&P.addClass("input-group-lg")}function h(){q={down:t(".bootstrap-touchspin-down",P),up:t(".bootstrap-touchspin-up",P),input:t("input",P),prefix:t(".bootstrap-touchspin-prefix",P).addClass(N.prefix_extraclass),postfix:t(".bootstrap-touchspin-postfix",P).addClass(N.postfix_extraclass)}}function v(){""===N.prefix&&(F=q.prefix.detach()),""===N.postfix&&(M=q.postfix.detach())}function x(){A.on("keydown.touchspin",function(t){var n=t.keyCode||t.which;38===n?("up"!==O&&(y(),j()),t.preventDefault()):40===n&&("down"!==O&&(k(),C()),t.preventDefault())}),A.on("keyup.touchspin",function(t){var n=t.keyCode||t.which;38===n?D():40===n&&D()}),A.on("blur.touchspin",function(){w(),A.val(N.callback_after_calculation(A.val()))}),q.down.on("keydown",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||("down"!==O&&(k(),C()),t.preventDefault())}),q.down.on("keyup.touchspin",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||D()}),q.up.on("keydown.touchspin",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||("up"!==O&&(y(),j()),t.preventDefault())}),q.up.on("keyup.touchspin",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||D()}),q.down.on("mousedown.touchspin",function(t){q.down.off("touchstart.touchspin"),A.is(":disabled")||(k(),C(),t.preventDefault(),t.stopPropagation())}),q.down.on("touchstart.touchspin",function(t){q.down.off("mousedown.touchspin"),A.is(":disabled")||(k(),C(),t.preventDefault(),t.stopPropagation())}),q.up.on("mousedown.touchspin",function(t){q.up.off("touchstart.touchspin"),A.is(":disabled")||(y(),j(),t.preventDefault(),t.stopPropagation())}),q.up.on("touchstart.touchspin",function(t){q.up.off("mousedown.touchspin"),A.is(":disabled")||(y(),j(),t.preventDefault(),t.stopPropagation())}),q.up.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(t){O&&(t.stopPropagation(),D())}),q.down.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(t){O&&(t.stopPropagation(),D())}),q.down.on("mousemove.touchspin touchmove.touchspin",function(t){O&&(t.stopPropagation(),t.preventDefault())}),q.up.on("mousemove.touchspin touchmove.touchspin",function(t){O&&(t.stopPropagation(),t.preventDefault())}),A.on("mousewheel.touchspin DOMMouseScroll.touchspin",function(t){if(N.mousewheel&&A.is(":focus")){var n=t.originalEvent.wheelDelta||-t.originalEvent.deltaY||-t.originalEvent.detail;t.stopPropagation(),t.preventDefault(),0>n?k():y()}})}function g(){A.on("touchspin.destroy",function(){c()}),A.on("touchspin.uponce",function(){D(),y()}),A.on("touchspin.downonce",function(){D(),k()}),A.on("touchspin.startupspin",function(){j()}),A.on("touchspin.startdownspin",function(){C()}),A.on("touchspin.stopspin",function(){D()}),A.on("touchspin.updatesettings",function(t,n){e(n)})}function m(t){switch(N.forcestepdivisibility){case"round":return(Math.round(t/N.step)*N.step).toFixed(N.decimals);case"floor":return(Math.floor(t/N.step)*N.step).toFixed(N.decimals);case"ceil":return(Math.ceil(t/N.step)*N.step).toFixed(N.decimals);default:return t}}function w(){var t,n,o;return t=N.callback_before_calculation(A.val()),""===t?void(""!==N.replacementval&&(A.val(N.replacementval),A.trigger("change"))):void(N.decimals>0&&"."===t||(n=parseFloat(t),isNaN(n)&&(n=""!==N.replacementval?N.replacementval:0),o=n,n.toString()!==t&&(o=n),null!==N.min&&n<N.min&&(o=N.min),null!==N.max&&n>N.max&&(o=N.max),o=m(o),Number(t).toString()!==o.toString()&&(A.val(o),A.trigger("change"))))}function _(){if(N.booster){var t=Math.pow(2,Math.floor(V/N.boostat))*N.step;return N.maxboostedstep&&t>N.maxboostedstep&&(t=N.maxboostedstep,S=Math.round(S/t)*t),Math.max(N.step,t)}return N.step}function y(){w(),S=parseFloat(N.callback_before_calculation(q.input.val())),isNaN(S)&&(S=0);var t=S,n=_();S+=n,null!==N.max&&S>N.max&&(S=N.max,A.trigger("touchspin.on.max"),D()),q.input.val(N.callback_after_calculation(Number(S).toFixed(N.decimals))),t!==S&&A.trigger("change")}function k(){w(),S=parseFloat(N.callback_before_calculation(q.input.val())),isNaN(S)&&(S=0);var t=S,n=_();S-=n,null!==N.min&&S<N.min&&(S=N.min,A.trigger("touchspin.on.min"),D()),q.input.val(N.callback_after_calculation(Number(S).toFixed(N.decimals))),t!==S&&A.trigger("change")}function C(){D(),V=0,O="down",A.trigger("touchspin.on.startspin"),A.trigger("touchspin.on.startdownspin"),I=setTimeout(function(){T=setInterval(function(){V++,k()},N.stepinterval)},N.stepintervaldelay)}function j(){D(),V=0,O="up",A.trigger("touchspin.on.startspin"),A.trigger("touchspin.on.startupspin"),z=setTimeout(function(){B=setInterval(function(){V++,y()},N.stepinterval)},N.stepintervaldelay)}function D(){switch(clearTimeout(I),clearTimeout(z),clearInterval(T),clearInterval(B),O){case"up":A.trigger("touchspin.on.stopupspin"),A.trigger("touchspin.on.stopspin");break;case"down":A.trigger("touchspin.on.stopdownspin"),A.trigger("touchspin.on.stopspin")}V=0,O=!1}var N,F,M,P,q,S,T,B,I,z,A=t(this),E=A.data(),V=0,O=!1;a()})}});